<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Challenge Tracker - PMProHabiba</title>
    <meta name="description" content="Track your career development challenges with daily streaks and progress monitoring.">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üéØ</text></svg>">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700;800&family=Sora:wght@300;400;500;600&display=swap');
        
        :root {
            --primary: #667eea;
            --primary-dark: #5a67d8;
            --secondary: #764ba2;
            --accent: #f093fb;
            --success: #48bb78;
            --warning: #f6ad55;
            --danger: #f56565;
            --bg: #ffffff;
            --bg-alt: #f7fafc;
            --card: #ffffff;
            --text: #2d3748;
            --text-light: #4a5568;
            --border: #e2e8f0;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            --gradient: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        }

        [data-theme="dark"] {
            --bg: #0f1419;
            --bg-alt: #1a202c;
            --card: #2d3748;
            --text: #e2e8f0;
            --text-light: #a0aec0;
            --border: #4a5568;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Sora', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-alt);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-alt);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            gap: 1rem;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .theme-toggle {
            position: fixed;
            top: 100px;
            right: 20px;
            background: var(--card);
            border: 2px solid var(--border);
            border-radius: 50px;
            padding: 12px 15px;
            cursor: pointer;
            z-index: 1000;
            font-size: 1.3rem;
            box-shadow: var(--shadow);
            transition: all 0.3s;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-lg);
        }

        .theme-toggle .sun { display: none; }
        .theme-toggle .moon { display: block; }
        [data-theme="dark"] .theme-toggle .sun { display: block; }
        [data-theme="dark"] .theme-toggle .moon { display: none; }

        .header {
            background: var(--card);
            backdrop-filter: blur(10px);
            border-bottom: 2px solid var(--border);
            padding: 1.5rem 2rem;
            position: sticky;
            top: 0;
            z-index: 999;
            box-shadow: var(--shadow);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
        }

        .logo {
            font-family: 'Outfit', sans-serif;
            font-size: 1.5rem;
            font-weight: 800;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .back-home {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: var(--gradient);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
            font-size: 0.95rem;
        }

        .back-home:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .user-bar {
            background: var(--card);
            padding: 1rem 2rem;
            border-bottom: 1px solid var(--border);
        }

        .user-bar-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .user-email {
            font-size: 0.9rem;
            color: var(--text-light);
            font-weight: 500;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 12px;
            font-family: 'Sora', sans-serif;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--gradient);
            color: white;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: var(--card);
            color: var(--text);
            border: 2px solid var(--border);
        }

        .btn-secondary:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .login-container {
            min-height: calc(100vh - 80px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .login-box {
            background: var(--card);
            padding: 3rem;
            border-radius: 20px;
            box-shadow: var(--shadow-lg);
            max-width: 450px;
            width: 100%;
            border: 2px solid var(--border);
        }

        .login-title {
            font-family: 'Outfit', sans-serif;
            font-size: 2rem;
            font-weight: 800;
            text-align: center;
            margin-bottom: 0.5rem;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .login-subtitle {
            text-align: center;
            color: var(--text-light);
            margin-bottom: 2rem;
            font-size: 0.95rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text);
            font-size: 0.9rem;
        }

        .form-input {
            width: 100%;
            padding: 0.875rem 1.125rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-family: 'Sora', sans-serif;
            font-size: 0.95rem;
            background: var(--bg);
            color: var(--text);
            transition: all 0.3s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-input::placeholder {
            color: var(--text-light);
            opacity: 0.6;
        }

        .submit-btn {
            width: 100%;
            padding: 1rem;
            background: var(--gradient);
            color: white;
            border: none;
            border-radius: 12px;
            font-family: 'Sora', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
            margin-top: 0.5rem;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .error-message {
            background: rgba(245, 101, 101, 0.1);
            color: var(--danger);
            padding: 0.875rem 1.125rem;
            border-radius: 10px;
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
            border: 2px solid rgba(245, 101, 101, 0.2);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .success-message {
            background: rgba(72, 187, 120, 0.1);
            color: var(--success);
            padding: 0.875rem 1.125rem;
            border-radius: 10px;
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
            border: 2px solid rgba(72, 187, 120, 0.2);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .pending-container {
            min-height: calc(100vh - 80px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .pending-box {
            background: var(--card);
            padding: 3rem;
            border-radius: 20px;
            box-shadow: var(--shadow-lg);
            max-width: 500px;
            width: 100%;
            text-align: center;
            border: 2px solid var(--border);
        }

        .pending-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .pending-title {
            font-family: 'Outfit', sans-serif;
            font-size: 1.75rem;
            font-weight: 800;
            margin-bottom: 1rem;
            color: var(--text);
        }

        .pending-text {
            color: var(--text-light);
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--card);
            padding: 1.75rem;
            border-radius: 16px;
            border: 2px solid var(--border);
            box-shadow: var(--shadow);
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary);
        }

        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 0.75rem;
            display: block;
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--text-light);
            margin-bottom: 0.5rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-value {
            font-size: 2.25rem;
            font-weight: 800;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-family: 'Outfit', sans-serif;
        }

        .challenges-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1.5rem;
        }

        .challenge-card {
            background: var(--card);
            border: 2px solid var(--border);
            border-radius: 20px;
            padding: 2rem;
            transition: all 0.3s;
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
        }

        .challenge-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary);
        }

        .challenge-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .challenge-title {
            font-family: 'Outfit', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.75rem;
            color: var(--text);
        }

        .challenge-description {
            color: var(--text-light);
            margin-bottom: 1.5rem;
            line-height: 1.6;
            flex-grow: 1;
        }

        .challenge-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 1rem;
            border-top: 2px solid var(--border);
            margin-bottom: 1rem;
        }

        .challenge-duration {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-light);
            font-weight: 600;
            font-size: 0.9rem;
        }

        .progress-container {
            background: var(--bg-alt);
            padding: 2rem;
            border-radius: 16px;
            margin-bottom: 2rem;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .progress-title {
            font-family: 'Outfit', sans-serif;
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text);
        }

        .streak-badge {
            background: var(--gradient);
            color: white;
            padding: 0.5rem 1.25rem;
            border-radius: 25px;
            font-weight: 700;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .progress-bar-container {
            background: var(--card);
            border-radius: 12px;
            height: 40px;
            overflow: hidden;
            position: relative;
            border: 2px solid var(--border);
        }

        .progress-bar {
            height: 100%;
            background: var(--gradient);
            transition: width 0.6s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 1rem;
        }

        .progress-text {
            color: white;
            font-weight: 700;
            font-size: 0.9rem;
        }

        .tasks-container {
            background: var(--card);
            padding: 2rem;
            border-radius: 16px;
            border: 2px solid var(--border);
        }

        .section-title {
            font-family: 'Outfit', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: var(--text);
        }

        .task-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.25rem;
            background: var(--bg-alt);
            border-radius: 12px;
            margin-bottom: 1rem;
            border: 2px solid var(--border);
            transition: all 0.3s;
        }

        .task-item:hover {
            border-color: var(--primary);
            transform: translateX(4px);
        }

        .task-item.completed {
            background: rgba(72, 187, 120, 0.1);
            border-color: var(--success);
        }

        .task-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .task-checkbox {
            width: 28px;
            height: 28px;
            border: 3px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            background: var(--card);
        }

        .task-checkbox:hover {
            border-color: var(--primary);
            transform: scale(1.1);
        }

        .task-checkbox.checked {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        .task-name {
            font-weight: 600;
            color: var(--text);
            font-size: 1rem;
        }

        .task-item.completed .task-name {
            color: var(--success);
        }

        .checkin-btn {
            width: 100%;
            margin-top: 2rem;
            padding: 1.25rem;
            font-size: 1.1rem;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 1rem;
            animation: fadeIn 0.2s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal {
            background: var(--card);
            border-radius: 20px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            border: 2px solid var(--border);
            animation: slideUp 0.3s;
        }

        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            padding: 2rem;
            border-bottom: 2px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-family: 'Outfit', sans-serif;
            font-size: 1.75rem;
            font-weight: 800;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .close-btn {
            background: var(--bg-alt);
            border: 2px solid var(--border);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.5rem;
            color: var(--text);
        }

        .close-btn:hover {
            background: var(--danger);
            border-color: var(--danger);
            color: white;
            transform: rotate(90deg);
        }

        .modal form {
            padding: 2rem;
        }

        .admin-nav {
            background: var(--card);
            border-bottom: 2px solid var(--border);
            padding: 0 2rem;
            display: flex;
            gap: 2rem;
            overflow-x: auto;
        }

        .admin-nav-item {
            padding: 1.25rem 0;
            cursor: pointer;
            font-weight: 600;
            color: var(--text-light);
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .admin-nav-item:hover {
            color: var(--primary);
        }

        .admin-nav-item.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .admin-main {
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .users-table-container {
            background: var(--card);
            border-radius: 16px;
            border: 2px solid var(--border);
            overflow: hidden;
        }

        .users-table {
            width: 100%;
            border-collapse: collapse;
        }

        .users-table th {
            background: var(--bg-alt);
            padding: 1.25rem;
            text-align: left;
            font-weight: 700;
            color: var(--text);
            border-bottom: 2px solid var(--border);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .users-table td {
            padding: 1.25rem;
            border-bottom: 1px solid var(--border);
            color: var(--text);
        }

        .users-table tr:hover {
            background: var(--bg-alt);
        }

        .status-badge {
            padding: 0.375rem 0.875rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
        }

        .status-approved {
            background: rgba(72, 187, 120, 0.15);
            color: var(--success);
        }

        .status-pending {
            background: rgba(246, 173, 85, 0.15);
            color: var(--warning);
        }

        .info-box {
            background: rgba(102, 126, 234, 0.1);
            border-left: 4px solid var(--primary);
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 2rem;
        }

        .info-box-title {
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.05rem;
        }

        .info-box-content {
            color: var(--text-light);
            line-height: 1.6;
            font-size: 0.95rem;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(40px, 1fr));
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .calendar-day {
            aspect-ratio: 1;
            border-radius: 8px;
            border: 2px solid var(--border);
            background: var(--card);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-light);
            transition: all 0.3s;
            cursor: pointer;
        }

        .calendar-day:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow);
        }

        .calendar-day.completed {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        .calendar-day.today {
            border-color: var(--primary);
            border-width: 3px;
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .challenges-grid {
                grid-template-columns: 1fr;
            }

            .admin-nav {
                gap: 1rem;
                padding: 0 1rem;
            }

            .users-table {
                font-size: 0.85rem;
            }

            .users-table th,
            .users-table td {
                padding: 0.875rem 0.5rem;
            }

            .container, .admin-main {
                padding: 1rem;
            }
        }

        .firebase-warning {
            background: rgba(245, 101, 101, 0.1);
            border: 2px solid var(--danger);
            padding: 2rem;
            border-radius: 12px;
            margin: 2rem;
            text-align: center;
        }

        .firebase-warning h2 {
            color: var(--danger);
            margin-bottom: 1rem;
        }

        .firebase-warning code {
            background: var(--card);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="theme-toggle" onclick="toggleTheme()">
        <span class="sun">‚òÄÔ∏è</span>
        <span class="moon">üåô</span>
    </div>

    <div id="app">
        <div class="loading-overlay">
            <div class="loading-spinner"></div>
            <div style="color: var(--text-light); font-weight: 600;">Loading...</div>
        </div>
    </div>

    <script>
        // ====================================================================
        // FIREBASE CONFIGURATION
        // ====================================================================
        // IMPORTANT: Replace these with your actual Firebase config
        const firebaseConfig = {
    apiKey: "AIzaSyD_oycEr_bza7OLIeiC2wss8iaKAFaaeTM",
    authDomain: "challenge-tracker-new.firebaseapp.com",
    databaseURL: "https://challenge-tracker-new-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "challenge-tracker-new",
    storageBucket: "challenge-tracker-new.firebasestorage.app",
    messagingSenderId: "35927063819",
    appId: "1:35927063819:web:63c6e7712df756207fb60e"
  };

        // Check if Firebase is configured
        const isFirebaseConfigured = firebaseConfig.apiKey !== "YOUR_API_KEY_HERE";

        if (!isFirebaseConfigured) {
            document.getElementById('app').innerHTML = `
                <div class="firebase-warning">
                    <h2>‚ö†Ô∏è Firebase Not Configured</h2>
                    <p style="margin: 1rem 0; color: var(--text);">
                        This app requires Firebase setup. Please follow these steps:
                    </p>
                    <ol style="text-align: left; max-width: 600px; margin: 1rem auto; color: var(--text-light); line-height: 1.8;">
                        <li>Go to <a href="https://console.firebase.google.com" target="_blank" style="color: var(--primary);">Firebase Console</a></li>
                        <li>Create a new project (or use existing)</li>
                        <li>Enable "Realtime Database" in the Build section</li>
                        <li>Set database rules to allow read/write (see instructions below)</li>
                        <li>Get your config from Project Settings > General</li>
                        <li>Replace the <code>firebaseConfig</code> object in this HTML file</li>
                    </ol>
                    <p style="margin-top: 2rem; color: var(--text-light); font-size: 0.9rem;">
                        Scroll down in this file to find detailed instructions!
                    </p>
                </div>
            `;
            throw new Error('Firebase not configured');
        }

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // ====================================================================
        // DATABASE HELPER FUNCTIONS
        // ====================================================================
        async function dbGet(path) {
            const snapshot = await database.ref(path).once('value');
            return snapshot.val();
        }

        async function dbSet(path, data) {
            await database.ref(path).set(data);
        }

        async function dbUpdate(path, data) {
            await database.ref(path).update(data);
        }

        async function dbPush(path, data) {
            const newRef = database.ref(path).push();
            await newRef.set(data);
            return newRef.key;
        }

        // ====================================================================
        // APPLICATION STATE
        // ====================================================================
        const appState = {
            currentUser: null,
            view: 'login',
            currentChallenge: null,
            showCheckinModal: false,
            showAddModal: false,
            adminTab: 'users',
            challenges: [],
            users: [],
            progressData: {}
        };

        const defaultChallenges = [{
            id: '1',
            title: '75 Intentional',
            description: '75 Intentional is designed to help you master project management systems, think smarter, and grow beyond just your job title. It\'s about expanding your horizons and becoming intentional in life. Miss even a single task on any day, and the challenge resets to Day 1.',
            duration: 75,
            icon: 'üéØ',
            hasTasks: true,
            tasks: [
                { id: 'pmp-focus', name: 'PMP Focus Block', required: true },
                { id: 'concept-app', name: 'Concept to Application', required: true },
                { id: 'pm-output', name: 'One PM Output', required: true },
                { id: 'intentional-learning', name: 'Intentional Learning (Non PMP)', required: true },
                { id: 'dopamine-discipline', name: 'Dopamine Discipline', required: true },
                { id: 'progress-report', name: 'Progress Report', required: true }
            ],
            progressReportQuestions: [
                'What did I understand better today?',
                'Where did I rush?',
                'What would a better PM do here?'
            ]
        }];

        // ====================================================================
        // INITIALIZATION
        // ====================================================================
        async function initializeData() {
            try {
                // Check if challenges exist
                const challengesData = await dbGet('challenges');
                if (!challengesData) {
                    // Initialize with default challenges
                    await dbSet('challenges', defaultChallenges);
                    appState.challenges = defaultChallenges;
                } else {
                    appState.challenges = Object.values(challengesData);
                }

                // Check for logged-in user in localStorage (for session persistence)
                const savedEmail = localStorage.getItem('currentUserEmail');
                if (savedEmail) {
                    const usersData = await dbGet('users');
                    if (usersData) {
                        const users = Object.entries(usersData).map(([key, value]) => ({
                            id: key,
                            ...value
                        }));
                        const user = users.find(u => u.email === savedEmail);
                        if (user) {
                            appState.currentUser = user;
                            if (user.status === 'approved') {
                                if (user.role === 'admin') {
                                    appState.view = 'admin';
                                    await loadAdminData();
                                } else {
                                    appState.view = 'dashboard';
                                    await loadUserProgress();
                                }
                            } else {
                                appState.view = 'pending';
                            }
                        }
                    }
                }

                render();
            } catch (error) {
                console.error('Initialization error:', error);
                alert('Error loading data. Please refresh the page.');
            }
        }

        // ====================================================================
        // USER MANAGEMENT
        // ====================================================================
        async function handleLogin(event) {
            event.preventDefault();
            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value;

            if (!email || !password) {
                alert('Please fill in all fields');
                return;
            }

            try {
                // Get all users from Firebase
                const usersData = await dbGet('users');
                let users = [];
                
                if (usersData) {
                    users = Object.entries(usersData).map(([key, value]) => ({
                        id: key,
                        ...value
                    }));
                }

                const user = users.find(u => u.email === email);

                if (!user) {
                    // Create new user
                    const newUserId = await dbPush('users', {
                        email: email,
                        password: password,
                        status: 'pending',
                        role: 'user',
                        joinedAt: new Date().toISOString()
                    });

                    appState.currentUser = {
                        id: newUserId,
                        email: email,
                        password: password,
                        status: 'pending',
                        role: 'user'
                    };

                    localStorage.setItem('currentUserEmail', email);
                    appState.view = 'pending';
                    render();
                } else {
                    // Existing user login
                    if (user.password !== password) {
                        alert('Incorrect password');
                        return;
                    }

                    appState.currentUser = user;
                    localStorage.setItem('currentUserEmail', email);

                    if (user.status === 'pending') {
                        appState.view = 'pending';
                    } else if (user.role === 'admin') {
                        appState.view = 'admin';
                        await loadAdminData();
                    } else {
                        appState.view = 'dashboard';
                        await loadUserProgress();
                    }
                    
                    render();
                }
            } catch (error) {
                console.error('Login error:', error);
                alert('Login failed. Please try again.');
            }
        }

        async function loadUserProgress() {
            if (!appState.currentUser) return;
            
            try {
                const progressData = await dbGet(`progress/${appState.currentUser.id}`);
                if (progressData) {
                    appState.progressData = progressData;
                }
            } catch (error) {
                console.error('Error loading progress:', error);
            }
        }

        async function loadAdminData() {
            try {
                // Load users
                const usersData = await dbGet('users');
                if (usersData) {
                    appState.users = Object.entries(usersData).map(([key, value]) => ({
                        id: key,
                        ...value
                    }));
                }

                // Load all progress data
                const progressData = await dbGet('progress');
                if (progressData) {
                    appState.progressData = progressData;
                }
            } catch (error) {
                console.error('Error loading admin data:', error);
            }
        }

        function handleLogout() {
            appState.currentUser = null;
            appState.view = 'login';
            appState.progressData = {};
            localStorage.removeItem('currentUserEmail');
            render();
        }

        async function approveUser(userId) {
            try {
                await dbUpdate(`users/${userId}`, { status: 'approved' });
                await loadAdminData();
                render();
            } catch (error) {
                console.error('Error approving user:', error);
                alert('Failed to approve user');
            }
        }

        async function deleteUser(userId) {
            if (!confirm('Are you sure you want to delete this user?')) return;

            try {
                // Delete user
                await database.ref(`users/${userId}`).remove();
                
                // Delete their progress
                await database.ref(`progress/${userId}`).remove();
                
                await loadAdminData();
                render();
            } catch (error) {
                console.error('Error deleting user:', error);
                alert('Failed to delete user');
            }
        }

        // ====================================================================
        // CHALLENGE MANAGEMENT
        // ====================================================================
        function joinChallenge(challengeId) {
            const challenge = appState.challenges.find(c => c.id === challengeId);
            if (!challenge) return;

            appState.currentChallenge = challenge;
            
            // Initialize progress for this challenge if not exists
            if (!appState.progressData[challengeId]) {
                appState.progressData[challengeId] = {
                    challengeId: challengeId,
                    userId: appState.currentUser.id,
                    startDate: new Date().toISOString(),
                    currentStreak: 0,
                    longestStreak: 0,
                    totalDays: 0,
                    dailyData: {}
                };
            }

            render();
        }

        function leaveChallenge() {
            appState.currentChallenge = null;
            render();
        }

        async function addChallenge(title, description, duration, icon) {
            try {
                const newChallenge = {
                    id: 'c' + Date.now(),
                    title,
                    description,
                    duration: parseInt(duration),
                    icon,
                    tasks: [
                        { id: 't1', name: 'Task 1' },
                        { id: 't2', name: 'Task 2' },
                        { id: 't3', name: 'Task 3' }
                    ],
                    progressReportQuestions: [
                        'What did you accomplish today?',
                        'What challenges did you face?',
                        'What will you focus on tomorrow?'
                    ]
                };

                appState.challenges.push(newChallenge);
                await dbSet('challenges', appState.challenges);
                
                appState.showAddModal = false;
                render();
            } catch (error) {
                console.error('Error adding challenge:', error);
                alert('Failed to add challenge');
            }
        }

        async function resetChallenges() {
            if (!confirm('This will delete all challenges and reset to the default "75 Intentional" challenge. All user progress will be lost. Continue?')) {
                return;
            }

            try {
                appState.challenges = defaultChallenges;
                await dbSet('challenges', defaultChallenges);
                
                // Clear all user progress
                await database.ref('progress').remove();
                appState.progressData = {};
                
                alert('Challenges reset successfully!');
                render();
            } catch (error) {
                console.error('Error resetting challenges:', error);
                alert('Failed to reset challenges');
            }
        }

        // ====================================================================
        // PROGRESS TRACKING
        // ====================================================================
        async function handleCheckin(event) {
            event.preventDefault();

            const today = new Date().toISOString().split('T')[0];
            const challenge = appState.currentChallenge;
            
            if (!challenge) return;

            const tasks = {};
            challenge.tasks.forEach(task => {
                tasks[task.id] = document.getElementById(`task-${task.id}`).checked;
            });

            const allTasksComplete = Object.values(tasks).every(v => v);

            const progressReport = {};
            if (challenge.progressReportQuestions) {
                challenge.progressReportQuestions.forEach((q, idx) => {
                    progressReport[`q${idx}`] = document.getElementById(`report-q${idx}`).value;
                });
            }

            // Update progress
            const currentProgress = appState.progressData[challenge.id] || {
                challengeId: challenge.id,
                userId: appState.currentUser.id,
                startDate: new Date().toISOString(),
                currentStreak: 0,
                longestStreak: 0,
                totalDays: 0,
                dailyData: {}
            };

            currentProgress.dailyData[today] = {
                date: today,
                tasks: tasks,
                progressReport: progressReport,
                completed: allTasksComplete
            };

            // Calculate streaks
            const dates = Object.keys(currentProgress.dailyData).sort();
            let currentStreak = 0;
            let longestStreak = 0;
            let tempStreak = 0;

            for (let i = 0; i < dates.length; i++) {
                if (currentProgress.dailyData[dates[i]].completed) {
                    tempStreak++;
                    if (i === dates.length - 1) {
                        currentStreak = tempStreak;
                    }
                } else {
                    if (i === dates.length - 1) {
                        currentStreak = 0;
                    }
                    longestStreak = Math.max(longestStreak, tempStreak);
                    tempStreak = 0;
                }
            }
            longestStreak = Math.max(longestStreak, tempStreak);

            currentProgress.currentStreak = currentStreak;
            currentProgress.longestStreak = longestStreak;
            currentProgress.totalDays = dates.filter(d => currentProgress.dailyData[d].completed).length;

            appState.progressData[challenge.id] = currentProgress;

            // Save to Firebase
            try {
                await dbSet(`progress/${appState.currentUser.id}/${challenge.id}`, currentProgress);
                appState.showCheckinModal = false;
                render();
            } catch (error) {
                console.error('Error saving progress:', error);
                alert('Failed to save progress');
            }
        }

        // ====================================================================
        // UI FUNCTIONS
        // ====================================================================
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        }

        // ====================================================================
        // RENDER FUNCTIONS
        // ====================================================================
        function renderLogin() {
            return `
                <div class="header">
                    <div class="header-content">
                        <div class="logo">
                            <span>üéØ</span>
                            <span>PMProHabiba</span>
                        </div>
                        <a href="https://pmprohabiba.com" class="back-home">
                            <span>üè†</span>
                            <span>Back to Home</span>
                        </a>
                    </div>
                </div>

                <div class="login-container">
                    <div class="login-box">
                        <h1 class="login-title">Welcome Back</h1>
                        <p class="login-subtitle">Sign in or create your account to start tracking challenges</p>

                        <form onsubmit="handleLogin(event)">
                            <div class="form-group">
                                <label class="form-label" for="email">Email Address</label>
                                <input
                                    type="email"
                                    id="email"
                                    class="form-input"
                                    placeholder="your@email.com"
                                    required
                                />
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="password">Password</label>
                                <input
                                    type="password"
                                    id="password"
                                    class="form-input"
                                    placeholder="Enter your password"
                                    required
                                />
                            </div>

                            <button type="submit" class="submit-btn">
                                Sign In / Sign Up
                            </button>
                        </form>

                        <div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 2px solid var(--border); text-align: center; color: var(--text-light); font-size: 0.85rem;">
                            <p>New users will be created automatically and pending admin approval.</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderPendingApproval() {
            return `
                <div class="header">
                    <div class="header-content">
                        <div class="logo">
                            <span>üéØ</span>
                            <span>PMProHabiba</span>
                        </div>
                        <button class="btn btn-secondary" onclick="handleLogout()">
                            <span>üëã</span>
                            Logout
                        </button>
                    </div>
                </div>

                <div class="pending-container">
                    <div class="pending-box">
                        <div class="pending-icon">‚è≥</div>
                        <h2 class="pending-title">Account Pending Approval</h2>
                        <p class="pending-text">
                            Your account has been created successfully! An administrator needs to approve your account before you can access the challenge tracker.
                            <br><br>
                            <strong>Email:</strong> ${appState.currentUser.email}
                            <br><br>
                            Please check back later or contact the administrator.
                        </p>
                        <button class="btn btn-primary" onclick="handleLogout()">
                            Return to Login
                        </button>
                    </div>
                </div>
            `;
        }

        function renderDashboard() {
            const progress = appState.currentChallenge 
                ? appState.progressData[appState.currentChallenge.id] 
                : null;

            if (!appState.currentChallenge) {
                return `
                    <div class="header">
                        <div class="header-content">
                            <div class="logo">
                                <span>üéØ</span>
                                <span>Challenge Tracker</span>
                            </div>
                            <button class="btn btn-secondary" onclick="handleLogout()">
                                <span>üëã</span>
                                Logout
                            </button>
                        </div>
                    </div>

                    <div class="user-bar">
                        <div class="user-bar-content">
                            <div class="user-email">
                                <strong>üë§</strong> ${appState.currentUser.email}
                            </div>
                        </div>
                    </div>

                    <div class="container">
                        <h2 class="section-title">
                            <span>üéØ</span>
                            Choose Your Challenge
                        </h2>

                        <div class="challenges-grid">
                            ${appState.challenges.map(challenge => `
                                <div class="challenge-card">
                                    <div class="challenge-icon">${challenge.icon}</div>
                                    <h3 class="challenge-title">${challenge.title}</h3>
                                    <p class="challenge-description">${challenge.description}</p>
                                    <div class="challenge-meta">
                                        <div class="challenge-duration">
                                            <span>üìÖ</span>
                                            ${challenge.duration} days
                                        </div>
                                    </div>
                                    <button class="btn btn-primary" onclick="joinChallenge('${challenge.id}')" style="width: 100%; margin-top: 1rem;">
                                        <span>üöÄ</span>
                                        Start Challenge
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            const today = new Date().toISOString().split('T')[0];
            const todayComplete = progress?.dailyData?.[today]?.completed || false;
            const progressPercent = progress 
                ? Math.round((progress.totalDays / appState.currentChallenge.duration) * 100)
                : 0;

            return `
                <div class="header">
                    <div class="header-content">
                        <div class="logo">
                            <span>${appState.currentChallenge.icon}</span>
                            <span>${appState.currentChallenge.title}</span>
                        </div>
                        <div style="display: flex; gap: 1rem;">
                            <button class="btn btn-secondary" onclick="leaveChallenge()">
                                <span>‚Üê</span>
                                Change Challenge
                            </button>
                            <button class="btn btn-secondary" onclick="handleLogout()">
                                <span>üëã</span>
                                Logout
                            </button>
                        </div>
                    </div>
                </div>

                <div class="user-bar">
                    <div class="user-bar-content">
                        <div class="user-email">
                            <strong>üë§</strong> ${appState.currentUser.email}
                        </div>
                    </div>
                </div>

                <div class="container">
                    <!-- Stats -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <span class="stat-icon">üî•</span>
                            <div class="stat-label">Current Streak</div>
                            <div class="stat-value">${progress?.currentStreak || 0}</div>
                        </div>
                        <div class="stat-card">
                            <span class="stat-icon">üèÜ</span>
                            <div class="stat-label">Longest Streak</div>
                            <div class="stat-value">${progress?.longestStreak || 0}</div>
                        </div>
                        <div class="stat-card">
                            <span class="stat-icon">üìä</span>
                            <div class="stat-label">Total Days</div>
                            <div class="stat-value">${progress?.totalDays || 0} / ${appState.currentChallenge.duration}</div>
                        </div>
                    </div>

                    <!-- Progress Bar -->
                    <div class="progress-container">
                        <div class="progress-header">
                            <h3 class="progress-title">Challenge Progress</h3>
                            <div class="streak-badge">
                                <span>üî•</span>
                                <span>${progress?.currentStreak || 0} Day Streak</span>
                            </div>
                        </div>
                        <div class="progress-bar-container">
                            <div class="progress-bar" style="width: ${progressPercent}%">
                                <span class="progress-text">${progressPercent}%</span>
                            </div>
                        </div>
                    </div>

                    <!-- Daily Tasks -->
                    <div class="tasks-container">
                        <h3 class="section-title">
                            <span>‚úÖ</span>
                            Today's Tasks
                        </h3>

                        ${todayComplete ? `
                            <div class="success-message">
                                <span>üéâ</span>
                                <span>You've completed today's check-in! Come back tomorrow!</span>
                            </div>
                            
                            <!-- Show completed tasks -->
                            ${appState.currentChallenge.tasks.map(task => {
                                const isComplete = progress?.dailyData?.[today]?.tasks?.[task.id] || false;
                                return `
                                    <div class="task-item ${isComplete ? 'completed' : ''}">
                                        <div class="task-info">
                                            <div class="task-checkbox ${isComplete ? 'checked' : ''}">
                                                ${isComplete ? '‚úì' : ''}
                                            </div>
                                            <span class="task-name">${task.name}</span>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        ` : `
                            <!-- Show task list before check-in -->
                            <div style="background: var(--bg-alt); padding: 1.5rem; border-radius: 12px; margin-bottom: 1.5rem;">
                                <h4 style="margin-bottom: 1rem; color: var(--text); font-size: 0.95rem;">
                                    üìã Today you need to complete:
                                </h4>
                                <ul style="list-style: none; padding: 0; margin: 0;">
                                    ${appState.currentChallenge.tasks.map(task => `
                                        <li style="padding: 0.5rem 0; color: var(--text-light); display: flex; align-items: center; gap: 0.5rem;">
                                            <span style="color: var(--primary);">‚ñ∏</span>
                                            ${task.name}
                                        </li>
                                    `).join('')}
                                </ul>
                            </div>
                            
                            <button class="btn btn-primary checkin-btn" onclick="appState.showCheckinModal = true; render();">
                                <span>‚úì</span>
                                Complete Today's Check-in
                            </button>
                        `}
                    </div>

                    <!-- Calendar View -->
                    ${progress && Object.keys(progress.dailyData).length > 0 ? `
                        <div class="tasks-container" style="margin-top: 2rem;">
                            <h3 class="section-title">
                                <span>üìÖ</span>
                                Progress Calendar
                            </h3>
                            <div class="calendar-grid">
                                ${Array.from({length: appState.currentChallenge.duration}, (_, i) => {
                                    const startDate = new Date(progress.startDate);
                                    const currentDate = new Date(startDate);
                                    currentDate.setDate(startDate.getDate() + i);
                                    const dateStr = currentDate.toISOString().split('T')[0];
                                    const isComplete = progress.dailyData[dateStr]?.completed || false;
                                    const isToday = dateStr === today;
                                    
                                    return `
                                        <div class="calendar-day ${isComplete ? 'completed' : ''} ${isToday ? 'today' : ''}"
                                             title="${dateStr}">
                                            ${i + 1}
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    ` : ''}
                </div>

                ${appState.showCheckinModal ? renderCheckinModal() : ''}
            `;
        }

        function renderCheckinModal() {
            const challenge = appState.currentChallenge;
            
            return `
                <div class="modal-overlay" onclick="appState.showCheckinModal = false; render();">
                    <div class="modal" onclick="event.stopPropagation();">
                        <div class="modal-header">
                            <h2 class="modal-title">Daily Check-in</h2>
                            <button class="close-btn" onclick="appState.showCheckinModal = false; render();">
                                ‚úï
                            </button>
                        </div>

                        <form onsubmit="handleCheckin(event)">
                            <h4 style="margin-bottom: 1rem; color: var(--text);">‚úÖ Complete Your Tasks</h4>
                            ${challenge.tasks.map(task => `
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.75rem; cursor: pointer; padding: 0.75rem; background: var(--bg-alt); border-radius: 8px;">
                                        <input
                                            type="checkbox"
                                            id="task-${task.id}"
                                            style="width: 20px; height: 20px; cursor: pointer;"
                                        />
                                        <span style="font-weight: 500;">${task.name}</span>
                                    </label>
                                </div>
                            `).join('')}

                            ${challenge.progressReportQuestions ? `
                                <h4 style="margin: 2rem 0 1rem; color: var(--text);">üìù Progress Report</h4>
                                ${challenge.progressReportQuestions.map((question, idx) => `
                                    <div class="form-group">
                                        <label class="form-label">${String.fromCharCode(97 + idx)}. ${question}</label>
                                        <textarea
                                            id="report-q${idx}"
                                            class="form-input"
                                            rows="3"
                                            placeholder="Your answer..."
                                        ></textarea>
                                    </div>
                                `).join('')}
                            ` : ''}

                            <button type="submit" class="btn btn-primary checkin-btn">
                                <span>‚úì</span>
                                Submit Check-in
                            </button>
                        </form>
                    </div>
                </div>
            `;
        }

        function renderAdminPanel() {
            const tabs = [
                { id: 'users', label: 'Users', icon: 'üë•' },
                { id: 'activity', label: 'Activity', icon: 'üìä' },
                { id: 'challenges', label: 'Challenges', icon: 'üéØ' }
            ];

            return `
                <div class="header">
                    <div class="header-content">
                        <div class="logo">
                            <span>‚öôÔ∏è</span>
                            <span>Admin Panel</span>
                        </div>
                        <button class="btn btn-secondary" onclick="handleLogout()">
                            <span>üëã</span>
                            Logout
                        </button>
                    </div>
                </div>

                <div class="admin-nav">
                    ${tabs.map(tab => `
                        <div class="admin-nav-item ${appState.adminTab === tab.id ? 'active' : ''}"
                             onclick="appState.adminTab = '${tab.id}'; render();">
                            <span>${tab.icon}</span>
                            <span>${tab.label}</span>
                        </div>
                    `).join('')}
                </div>

                ${appState.adminTab === 'users' ? renderUsersTab() : ''}
                ${appState.adminTab === 'activity' ? renderActivityTab() : ''}
                ${appState.adminTab === 'challenges' ? renderChallengesTab() : ''}
                ${appState.showAddModal ? renderAddChallengeModal() : ''}
            `;
        }

        function renderUsersTab() {
            return `
                <div class="admin-main">
                    <h3 class="section-title" style="margin-bottom: 2rem;">
                        <span>üë•</span>
                        User Management
                    </h3>

                    <div class="users-table-container">
                        <table class="users-table">
                            <thead>
                                <tr>
                                    <th>Email</th>
                                    <th>Status</th>
                                    <th>Role</th>
                                    <th>Joined</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${appState.users.map(user => `
                                    <tr>
                                        <td>${user.email}</td>
                                        <td>
                                            <span class="status-badge status-${user.status}">
                                                ${user.status === 'approved' ? '‚úì' : '‚è≥'}
                                                ${user.status}
                                            </span>
                                        </td>
                                        <td>${user.role}</td>
                                        <td>${new Date(user.joinedAt).toLocaleDateString()}</td>
                                        <td>
                                            <div style="display: flex; gap: 0.5rem;">
                                                ${user.status === 'pending' ? `
                                                    <button class="btn btn-primary" onclick="approveUser('${user.id}')" style="padding: 0.5rem 1rem; font-size: 0.85rem;">
                                                        Approve
                                                    </button>
                                                ` : ''}
                                                ${user.role !== 'admin' ? `
                                                    <button class="btn btn-danger" onclick="deleteUser('${user.id}')" style="padding: 0.5rem 1rem; font-size: 0.85rem;">
                                                        Delete
                                                    </button>
                                                ` : ''}
                                            </div>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderActivityTab() {
            const allUserProgress = [];
            
            // Compile all user progress
            Object.entries(appState.progressData).forEach(([userId, challenges]) => {
                const user = appState.users.find(u => u.id === userId);
                if (!user) return;
                
                Object.entries(challenges).forEach(([challengeId, progress]) => {
                    const challenge = appState.challenges.find(c => c.id === challengeId);
                    if (!challenge) return;
                    
                    allUserProgress.push({
                        user,
                        challenge,
                        progress
                    });
                });
            });

            return `
                <div class="admin-main">
                    <h3 class="section-title" style="margin-bottom: 2rem;">
                        <span>üìä</span>
                        User Activity
                    </h3>

                    <div class="info-box">
                        <div class="info-box-title">
                            <span>üìä</span>
                            Activity Overview
                        </div>
                        <div class="info-box-content">
                            <strong>Total Users:</strong> ${appState.users.length}<br>
                            <strong>Active Challenges:</strong> ${allUserProgress.length}<br>
                            <strong>Pending Approvals:</strong> ${appState.users.filter(u => u.status === 'pending').length}
                        </div>
                    </div>

                    ${allUserProgress.length === 0 ? `
                        <div style="text-align: center; padding: 3rem; color: var(--text-light);">
                            <div style="font-size: 3rem; margin-bottom: 1rem;">üì≠</div>
                            <p>No user activity yet</p>
                        </div>
                    ` : `
                        ${allUserProgress.map(({ user, challenge, progress }) => {
                            // Get all completed days sorted by date (most recent first)
                            const completedDays = Object.entries(progress.dailyData || {})
                                .sort(([dateA], [dateB]) => dateB.localeCompare(dateA))
                                .slice(0, 10); // Show last 10 days
                            
                            return `
                                <div style="background: var(--card); border: 2px solid var(--border); border-radius: 20px; padding: 2rem; margin-bottom: 2rem; box-shadow: var(--shadow);">
                                    <!-- User Header -->
                                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 2px solid var(--border);">
                                        <div style="font-size: 2.5rem;">${challenge.icon}</div>
                                        <div style="flex: 1;">
                                            <div style="font-weight: 700; color: var(--text); font-size: 1.25rem;">${challenge.title}</div>
                                            <div style="color: var(--text-light); font-size: 0.9rem; margin-top: 0.25rem;">üë§ ${user.email}</div>
                                        </div>
                                    </div>

                                    <!-- Stats -->
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
                                        <div style="text-align: center; background: var(--bg-alt); padding: 1rem; border-radius: 12px;">
                                            <div style="font-size: 1.75rem; font-weight: 800; color: var(--primary);">
                                                ${progress.currentStreak || 0}
                                            </div>
                                            <div style="font-size: 0.75rem; color: var(--text-light); font-weight: 600; margin-top: 0.25rem;">
                                                Current Streak
                                            </div>
                                        </div>
                                        <div style="text-align: center; background: var(--bg-alt); padding: 1rem; border-radius: 12px;">
                                            <div style="font-size: 1.75rem; font-weight: 800; color: var(--primary);">
                                                ${progress.longestStreak || 0}
                                            </div>
                                            <div style="font-size: 0.75rem; color: var(--text-light); font-weight: 600; margin-top: 0.25rem;">
                                                Longest Streak
                                            </div>
                                        </div>
                                        <div style="text-align: center; background: var(--bg-alt); padding: 1rem; border-radius: 12px;">
                                            <div style="font-size: 1.75rem; font-weight: 800; color: var(--primary);">
                                                ${progress.totalDays || 0}
                                            </div>
                                            <div style="font-size: 0.75rem; color: var(--text-light); font-weight: 600; margin-top: 0.25rem;">
                                                Total Days
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Calendar -->
                                    <div style="margin-bottom: 2rem;">
                                        <h4 style="font-size: 0.95rem; font-weight: 700; color: var(--text); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                                            <span>üìÖ</span> Progress Calendar
                                        </h4>
                                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(35px, 1fr)); gap: 0.4rem;">
                                            ${Array.from({length: challenge.duration}, (_, i) => {
                                                const startDate = new Date(progress.startDate);
                                                const currentDate = new Date(startDate);
                                                currentDate.setDate(startDate.getDate() + i);
                                                const dateStr = currentDate.toISOString().split('T')[0];
                                                const isComplete = progress.dailyData?.[dateStr]?.completed || false;
                                                
                                                return `
                                                    <div style="aspect-ratio: 1; border-radius: 6px; border: 2px solid ${isComplete ? 'var(--success)' : 'var(--border)'}; background: ${isComplete ? 'var(--success)' : 'var(--card)'}; display: flex; align-items: center; justify-content: center; font-size: 0.7rem; font-weight: 600; color: ${isComplete ? 'white' : 'var(--text-light)'};"
                                                         title="${dateStr}${isComplete ? ' - Completed' : ' - Not completed'}">
                                                        ${i + 1}
                                                    </div>
                                                `;
                                            }).join('')}
                                        </div>
                                    </div>

                                    <!-- Daily Entries -->
                                    ${completedDays.length > 0 ? `
                                        <div>
                                            <h4 style="font-size: 0.95rem; font-weight: 700; color: var(--text); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                                                <span>üìù</span> Recent Daily Entries (Last 10 Days)
                                            </h4>
                                            
                                            ${completedDays.map(([date, dailyData]) => {
                                                const allTasksComplete = dailyData.completed;
                                                const formattedDate = new Date(date).toLocaleDateString('en-US', { 
                                                    weekday: 'short', 
                                                    year: 'numeric', 
                                                    month: 'short', 
                                                    day: 'numeric' 
                                                });
                                                
                                                return `
                                                    <div style="background: var(--bg-alt); border-left: 4px solid ${allTasksComplete ? 'var(--success)' : 'var(--danger)'}; padding: 1.5rem; border-radius: 8px; margin-bottom: 1rem;">
                                                        <!-- Date Header -->
                                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                                            <div style="font-weight: 700; color: var(--text); font-size: 0.95rem;">
                                                                üìÖ ${formattedDate}
                                                            </div>
                                                            <div style="background: ${allTasksComplete ? 'var(--success)' : 'var(--danger)'}; color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 700;">
                                                                ${allTasksComplete ? '‚úì Completed' : '‚úó Incomplete'}
                                                            </div>
                                                        </div>

                                                        <!-- Tasks -->
                                                        <div style="margin-bottom: 1.5rem;">
                                                            <h6 style="font-weight: 600; color: var(--text); margin-bottom: 0.75rem; font-size: 0.85rem;">
                                                                ‚úÖ Tasks:
                                                            </h6>
                                                            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 0.5rem;">
                                                                ${challenge.tasks.map(task => {
                                                                    const isComplete = dailyData.tasks?.[task.id];
                                                                    return `
                                                                        <div style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem; background: var(--card); border-radius: 6px;">
                                                                            <span style="color: ${isComplete ? 'var(--success)' : 'var(--danger)'}; font-size: 1rem; font-weight: 700;">
                                                                                ${isComplete ? '‚úì' : '‚úó'}
                                                                            </span>
                                                                            <span style="font-size: 0.8rem; color: var(--text); font-weight: 500;">${task.name}</span>
                                                                        </div>
                                                                    `;
                                                                }).join('')}
                                                            </div>
                                                        </div>

                                                        <!-- Progress Report -->
                                                        ${dailyData.progressReport && Object.keys(dailyData.progressReport).length > 0 ? `
                                                            <div>
                                                                <h6 style="font-weight: 600; color: var(--text); margin-bottom: 0.75rem; font-size: 0.85rem;">
                                                                    üìù Progress Report:
                                                                </h6>
                                                                <div style="display: flex; flex-direction: column; gap: 1rem;">
                                                                    ${challenge.progressReportQuestions.map((question, idx) => `
                                                                        <div style="background: var(--card); padding: 1rem; border-radius: 8px; border-left: 3px solid var(--primary);">
                                                                            <div style="font-weight: 600; color: var(--primary); margin-bottom: 0.5rem; font-size: 0.8rem;">
                                                                                ${String.fromCharCode(97 + idx)}. ${question}
                                                                            </div>
                                                                            <div style="color: var(--text); font-size: 0.85rem; line-height: 1.5; white-space: pre-wrap;">
                                                                                ${dailyData.progressReport[`q${idx}`] || '<em style="color: var(--text-light);">No answer provided</em>'}
                                                                            </div>
                                                                        </div>
                                                                    `).join('')}
                                                                </div>
                                                            </div>
                                                        ` : ''}
                                                    </div>
                                                `;
                                            }).join('')}
                                        </div>
                                    ` : `
                                        <div style="text-align: center; padding: 2rem; color: var(--text-light); background: var(--bg-alt); border-radius: 12px;">
                                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">üì≠</div>
                                            <p style="font-size: 0.9rem;">No daily entries yet</p>
                                        </div>
                                    `}
                                </div>
                            `;
                        }).join('')}
                    `}
                </div>
            `;
        }

        function renderChallengesTab() {
            return `
                <div class="admin-main">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; flex-wrap: wrap; gap: 1rem;">
                        <h3 class="section-title" style="margin: 0;">
                            <span>üéØ</span>
                            Manage Challenges
                        </h3>
                        <div style="display: flex; gap: 0.75rem; flex-wrap: wrap;">
                            <button class="btn btn-secondary" onclick="resetChallenges();">
                                üîÑ Reset to 75 Intentional
                            </button>
                            <button class="btn btn-primary" onclick="appState.showAddModal = true; render();">
                                <span>‚ûï</span>
                                Add New Challenge
                            </button>
                        </div>
                    </div>

                    <div class="info-box" style="margin-bottom: 2rem;">
                        <div class="info-box-title">
                            <span>üí°</span>
                            Challenge Management
                        </div>
                        <div class="info-box-content">
                            <strong>Reset to 75 Intentional:</strong> Removes all challenges and resets to the default "75 Intentional" challenge<br>
                            <strong>Add New Challenge:</strong> Create additional challenges for your users<br>
                            <em>Note: Users who joined old challenges will lose their progress when you reset</em>
                        </div>
                    </div>

                    <div class="challenges-grid">
                        ${appState.challenges.map(challenge => `
                            <div class="challenge-card">
                                <div class="challenge-icon">${challenge.icon}</div>
                                <h3 class="challenge-title">${challenge.title}</h3>
                                <p class="challenge-description">${challenge.description}</p>
                                <div class="challenge-meta">
                                    <div class="challenge-duration">
                                        <span>üìÖ</span>
                                        ${challenge.duration} days
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function renderAddChallengeModal() {
            return `
                <div class="modal-overlay" onclick="appState.showAddModal = false; render();">
                    <div class="modal" onclick="event.stopPropagation();">
                        <div class="modal-header">
                            <h2 class="modal-title">Add New Challenge</h2>
                            <button class="close-btn" onclick="appState.showAddModal = false; render();">
                                ‚úï
                            </button>
                        </div>

                        <form onsubmit="event.preventDefault(); 
                            const title = document.getElementById('newTitle').value;
                            const desc = document.getElementById('newDesc').value;
                            const duration = document.getElementById('newDuration').value;
                            const icon = document.getElementById('newIcon').value;
                            addChallenge(title, desc, duration, icon);">
                            
                            <div class="form-group">
                                <label class="form-label">Challenge Title</label>
                                <input
                                    type="text"
                                    id="newTitle"
                                    class="form-input"
                                    placeholder="e.g., Daily Resume Update"
                                    required
                                />
                            </div>

                            <div class="form-group">
                                <label class="form-label">Description</label>
                                <input
                                    type="text"
                                    id="newDesc"
                                    class="form-input"
                                    placeholder="What will users do?"
                                    required
                                />
                            </div>

                            <div class="form-group">
                                <label class="form-label">Duration (days)</label>
                                <input
                                    type="number"
                                    id="newDuration"
                                    class="form-input"
                                    value="30"
                                    min="1"
                                    required
                                />
                            </div>

                            <div class="form-group">
                                <label class="form-label">Icon Emoji</label>
                                <input
                                    type="text"
                                    id="newIcon"
                                    class="form-input"
                                    placeholder="üìÑ"
                                    value="üìÑ"
                                    required
                                />
                            </div>

                            <button type="submit" class="btn btn-primary checkin-btn">
                                <span>‚ûï</span>
                                Create Challenge
                            </button>
                        </form>
                    </div>
                </div>
            `;
        }

        function render() {
            const app = document.getElementById('app');
            
            if (appState.view === 'login') {
                app.innerHTML = renderLogin();
            } else if (appState.view === 'pending') {
                app.innerHTML = renderPendingApproval();
            } else if (appState.view === 'dashboard') {
                app.innerHTML = renderDashboard();
            } else if (appState.view === 'admin') {
                app.innerHTML = renderAdminPanel();
            }
        }

        // Load saved theme
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
            document.documentElement.setAttribute('data-theme', savedTheme);
        }

        // Initialize app
        initializeData();
    </script>
</body>
</html>

<!-- 
================================================================================
FIREBASE SETUP INSTRUCTIONS
================================================================================

1. GO TO FIREBASE CONSOLE
   Visit: https://console.firebase.google.com

2. CREATE A NEW PROJECT (or use existing)
   - Click "Add project"
   - Enter project name
   - Follow the setup wizard

3. ENABLE REALTIME DATABASE
   - In left sidebar, click "Build" > "Realtime Database"
   - Click "Create Database"
   - Choose location (e.g., us-central1)
   - Start in TEST MODE (we'll secure it in step 5)

4. GET YOUR FIREBASE CONFIG
   - Go to Project Settings (gear icon) > General
   - Scroll to "Your apps" section
   - Click the Web icon (</>) to add a web app
   - Register your app (name it anything)
   - Copy the firebaseConfig object
   - Paste it into this file, replacing the placeholder

5. SET UP SECURITY RULES
   - Go to Realtime Database > Rules tab
   - Replace with these rules:

{
  "rules": {
    "users": {
      ".read": true,
      ".write": true
    },
    "challenges": {
      ".read": true,
      ".write": true
    },
    "progress": {
      ".read": true,
      ".write": true
    }
  }
}

   - Click "Publish"

6. DEPLOY YOUR WEBSITE
   - Save this HTML file
   - Upload to your hosting (GitHub Pages, Netlify, etc.)
   - Your app is now live with centralized data storage!

================================================================================
IMPORTANT NOTES
================================================================================

- All users will now see the same data because it's stored in Firebase
- The admin can see all user progress from any device
- Data persists even if users close their browser
- Free tier includes: 1GB storage, 10GB/month downloads, 100 simultaneous connections

For production, you should:
1. Add Firebase Authentication for secure login
2. Update security rules to restrict access based on user roles
3. See Firebase docs: https://firebase.google.com/docs

================================================================================
-->
